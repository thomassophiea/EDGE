# Railway Configuration - Auto-updated on each deployment
# Last Update: 2025-12-31 20:44:58 UTC - Commit 2382952
[build]
builder = "nixpacks"

[build.nixpacksPlan]
phases.setup.nixPkgs = ["nodejs"]
phases.install.cmds = [
  "npm ci --no-cache",
  "echo 'Build started at:' $(date -u)"
]
phases.build.cmds = [
  "rm -rf node_modules/.vite build dist .cache",
  "echo 'Forcing clean build - clearing all caches'",
  "npm run build",
  "echo '{\"version\":\"'$(git describe --always)'\",\"commit\":\"'$(git rev-parse --short HEAD)'\",\"commitFull\":\"'$(git rev-parse HEAD)'\",\"buildDate\":\"'$(date -u +\"%Y-%m-%dT%H:%M:%SZ\")'\",\"message\":\"Campus Controller Integration: RFQI & Application Analytics\"}' > build/version.json",
  "cat build/version.json",
  "ls -la build/ | head -20",
  "echo 'Build completed at:' $(date -u)"
]

[deploy]
startCommand = "node server.js"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10
